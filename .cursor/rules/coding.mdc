---
description: C++ class layout and coding and comment and documentation conventions
globs:
alwaysApply: true
---

**ALWAYS compile and FIX ALL ERRORS after making changes**

# Class Layout

- Private data members first
- Public interface last
- Destructor first
- little to no ascii-art dividers
- Javadoc on almost all public functions
- struct if all public, else class
- never break encapsulation without explicit instruction
- don't call make_error_code directly unless necessary
- DO NOT use failed() with std::error_code, use if(ec)
- ALWAYS USE failed() ONLY with boost::system::error_code, instead of if(ec)
- always update the tests after changing code
- protect min max with paren (std::min)(...)
- include <algorithm> sparingly (not for min max), its costly
- always write unit tests for public headers, in corresponding cpp
- warn user when a lambda coroutine declares or uses captured values, its use-after-free
- use IILE parameters instead of captures in lambda coroutines
- don't include private headers from other libraries (e.g. detail/)
- use detail::throw_*, never naked throw at call sites

